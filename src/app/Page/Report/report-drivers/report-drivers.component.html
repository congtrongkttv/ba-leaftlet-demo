<app-form-report-base
  [pageTitle]="pageTitle"
  [modalTitle]="modalTitle"
  [columnsCustom]="baseManager.columnsGridCustom"
  [enableAdd]="authorized.canAdd"
  [enableOption]="authorized.canOption"
  (onSearch)="onSearch_Click()"
  (onCreate)="onCreate_Click()"
  (onSave)="onSave_Click($event)"
  (onSaveCustomColumns)="onSaveCustomColumns_Click($event)"
>
  <div class="rightpanel-search">
    <!-- Bắt đầu control search ở đây -->
    <table class="search-table-control">
      <tr style="width: 100%">
        <td>Từ ngày</td>
        <td>
          <kendo-datepicker
            #dtFromDate
            [(ngModel)]="fromDate"
            [format]="format"
          ></kendo-datepicker>
        </td>
        <td>Đến ngày</td>
        <td>
          <kendo-datepicker
            #dtToDate
            [(ngModel)]="toDate"
            [format]="format"
          ></kendo-datepicker>
        </td>
        <td>Lái xe</td>
        <td>
          <input
            type="text"
            placeholder="Nhập nội dung tìm kiếm"
            [(ngModel)]="searchContent"
          />
        </td>
        <td>
          <i
            value="Tìm kiếm"
            (click)="onSearch_Click()"
            class="fa fa-search fa-button fa-button-blue"
          >
            Tìm kiếm</i
          >
        </td>
      </tr>
    </table>

    <!-- kết thúc control search ở đây -->
  </div>

  <div class="rightpanel-data">
    <!-- Bắt đầu control grid ở đây -->
    <kendo-grid
      #grid
      [data]="dataGrid"
      [pageSize]="pageSize"
      [pageable]="true"
      [loading]="isLoading"
      [skip]="skip"
      scrollable="none"
      (remove)="onRowComand_Click($event)"
      (pageChange)="pageChange($event)"
      (excelExport)="exportExcel($event, grid)"
    >
      <ng-template kendoGridNoRecordsTemplate>
        Không có dữ liệu
        <i class="fa fa-refresh" (click)="this.bindData()"></i>
      </ng-template>
      <ng-template
        kendoGridToolbarTemplate
        *ngIf="this.dataGrid.data.length > 0 && authorized.canExport"
      >
        <i
          kendoGridExcelCommand
          class="fa fa-file-excel-o fa-button fa-button-white"
          aria-hidden="true"
          style="color: green"
          title="Xuất excel"
          icon="file-excel"
          >Xuất excel</i
        >
        <i
          kendoGridPDFCommand
          class="fa fa-file-pdf-o fa-button fa-button-white"
          aria-hidden="true"
          title="Xuất pdf"
          style="color: orangered"
          icon="file-pdf"
          (click)="exportPdf($event, grid)"
          >Xuất pdf</i
        >
      </ng-template>
      <kendo-grid-column
        [headerClass]="'table-report-header'"
        [class]="'table-report-body'"
        [footerClass]="'table-report-header'"
        title="STT"
        field="rowNumber"
        width="50"
      >
        <ng-template kendoGridCellTemplate let-rowIndex="rowIndex">
          {{ rowIndex + 1 }}
        </ng-template>
      </kendo-grid-column>
      <kendo-grid-column
        [headerClass]="'table-report-header'"
        [class]="'table-report-body'"
        [footerClass]="'table-report-header'"
        title="Công ty"
        field="FK_CompanyID"
        width="100"
      ></kendo-grid-column>
      <kendo-grid-column
        [headerClass]="'table-report-header'"
        [class]="'table-report-body'"
        [footerClass]="'table-report-header'"
        title="Phòng ban"
        field="FK_DepartmentID"
        width="100"
      ></kendo-grid-column>
      <kendo-grid-column
        [headerClass]="'table-report-header'"
        [class]="'table-report-body'"
        [footerClass]="'table-report-header'"
        title="Mã nhân viên"
        field="EmployeeCode"
        width="100"
      >
      </kendo-grid-column>
      <kendo-grid-column
        [headerClass]="'table-report-header'"
        [class]="'table-report-body'"
        [footerClass]="'table-report-header'"
        title="Tên đăng nhập"
        field="Name"
        width="100"
      >
      </kendo-grid-column>
      <kendo-grid-column
        [headerClass]="'table-report-header'"
        [class]="'table-report-body'"
        [footerClass]="'table-report-header'"
        title="Tên hiển thị"
        field="DisplayName"
        width="100"
      >
      </kendo-grid-column>

      <kendo-grid-column
        [headerClass]="'table-report-header'"
        [class]="'table-report-body'"
        [footerClass]="'table-report-header'"
        title="Ngày sinh"
        field="Birthday"
        width="100"
      >
        <ng-template kendoGridCellTemplate let-dataItem="dataItem">
          {{ dataItem.Birthday | date: "dd/MM/yyyy" }}
        </ng-template>
      </kendo-grid-column>

      <kendo-grid-column
        [headerClass]="'table-report-header'"
        [class]="'table-report-body'"
        [footerClass]="'table-report-header'"
        title="Flags"
        field="Flags"
        width="50"
      >
        <ng-template
          *ngIf="baseManager.columnsSummary.length > 0"
          kendoGridFooterTemplate
        >
          {{ columnsSummaryItems[7] }}
        </ng-template>
      </kendo-grid-column>

      <kendo-grid-column
        [headerClass]="'table-report-header'"
        [class]="'table-report-body'"
        [footerClass]="'table-report-header'"
        title="Sửa"
        field="updateCommand"
        width="50"
      >
        <ng-template kendoGridCellTemplate let-dataItem="dataItem">
          <i
            class="fa fa-edit"
            aria-hidden="true"
            (click)="
              onRowComand_Click({
                action: 'edit',
                dataItem: dataItem
              })
            "
          ></i>
        </ng-template>
      </kendo-grid-column>

      <kendo-grid-column
        [headerClass]="'table-report-header'"
        [class]="'table-report-body'"
        [footerClass]="'table-report-header'"
        title="Xóa"
        field="deleteCommand"
        width="50"
      >
        <ng-template kendoGridCellTemplate let-dataItem="dataItem">
          <i
            class="fa fa-remove"
            aria-hidden="true"
            (click)="
              onRowComand_Click({
                action: 'remove',
                dataItem: dataItem
              })
            "
          ></i>
        </ng-template>
      </kendo-grid-column>

      <kendo-grid-excel
        fileName="{{ reportName + '.xlsx' }}"
        [fetchData]="allDataGrid"
      >
      </kendo-grid-excel>
      <ng-template
        kendoPagerTemplate
        let-totalPages="totalPages"
        let-currentPage="currentPage"
      >
        <kendo-pager-prev-buttons></kendo-pager-prev-buttons>
        <kendo-pager-numeric-buttons
          [buttonCount]="buttonCount"
        ></kendo-pager-numeric-buttons>
        <kendo-pager-next-buttons></kendo-pager-next-buttons>
        <kendo-pager-info></kendo-pager-info>
      </ng-template>
    </kendo-grid>
    <!-- kết thúc control grid ở đây -->
  </div>

  <div class="modal-content">
    <!-- Bắt đầu cho modal ở đây -->
    <app-driver-edit [entity]="currentDataModel"></app-driver-edit>
    <!-- Kết thúc cho modal ở đây -->
  </div>
</app-form-report-base>
